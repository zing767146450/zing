(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0da394"],{"6b4f":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flow-form",style:{margin:"0 auto",width:t.formConf.fullScreenWidth}},[t.loading?t._e():a("parser",{key:t.key,ref:"dynamicForm",attrs:{"form-conf":t.formConf},on:{submit:t.sumbitForm}})],1)},n=[],o=a("826a"),s=a("ef22"),r=a("49aa"),f={components:{Parser:r["a"]},data:function(){return{formConf:{},formData:{},key:+new Date,loading:!0,eventType:"",dataForm:{id:"",data:"",flowId:""}}},methods:{init:function(t){var e=this;this.setting=t,this.formConf=t.formConf?JSON.parse(t.formConf):{},this.dataForm.id=t.id||"",this.loading=!0,this.$nextTick((function(){e.dataForm.id?1==t.type?Object(s["s"])(t.flowId,e.dataForm.id).then((function(t){e.dataForm=t.data,e.dataForm.data&&(e.formData=JSON.parse(e.dataForm.data),e.fillFormData(e.formConf,e.formData),e.$nextTick((function(){e.loading=!1,e.$emit("setPageLoad")})))})):Object(o["c"])(e.dataForm.id).then((function(t){e.dataForm=t.data,e.dataForm.data&&(e.formData=JSON.parse(e.dataForm.data),e.fillFormData(e.formConf,e.formData),e.$nextTick((function(){e.loading=!1,e.$emit("setPageLoad")})))})):(e.formData={},e.fillFormData(e.formConf,e.formData),e.$nextTick((function(){e.loading=!1,e.$emit("setPageLoad")})),e.dataForm.flowId=t.flowId),e.key=+new Date}))},fillFormData:function(t,e){var a=this;t.disabled=this.setting.readonly;var i=function t(i){for(var n=function(n){var o=i[n];if(o.__vModel__){var s=e[o.__vModel__];s&&(o.__config__.defaultValue=s);var r=!1,f=!0;if(a.setting.formOperates&&a.setting.formOperates.length){var d=a.setting.formOperates.filter((function(t){return t.id===o.__vModel__}))||[];if(d.length){var m=d[0];r=!m.read,f=!m.write}}else f=!1;f=o.disabled?o.disabled:f,r=o.__config__.noShow?o.__config__.noShow:r,a.setting.readonly&&(f=!0),a.$set(o,"disabled",f),a.$set(o.__config__,"noShow",r)}o.__config__&&"table"!==o.__config__.jnpfKey&&o.__config__.children&&Array.isArray(o.__config__.children)&&t(o.__config__.children)},o=0;o<i.length;o++)n(o)};i(t.fields)},sumbitForm:function(t){if(t)if(this.dataForm.data=JSON.stringify(t),1==this.setting.type){if("save"===this.eventType||"submit"===this.eventType)return void this.selfSubmit();this.$emit("eventReciver",this.dataForm,this.eventType)}else this.$emit("eventReciver",this.dataForm,this.eventType)},selfSubmit:function(){var t=this;if(this.dataForm.status="submit"===this.eventType?0:1,"save"===this.eventType)return this.selfHandleRequest();this.$confirm("您确定要提交当前流程吗, 是否继续?","提示",{type:"warning"}).then((function(){t.selfHandleRequest()})).catch((function(){}))},selfHandleRequest:function(){var t=this;this.dataForm.id||delete this.dataForm.id,"save"===this.eventType&&this.$emit("setLoad",!0);var e=this.dataForm.id?s["x"]:s["h"];e(this.setting.flowId,this.dataForm).then((function(e){t.$message({message:e.msg,type:"success",duration:1500,onClose:function(){"save"===t.eventType&&t.$emit("setLoad",!1),t.$emit("close",!0)}})})).catch((function(){"save"===t.eventType&&t.$emit("setLoad",!1)}))},dataFormSubmit:function(t){if(this.setting.isPreview)return this.$message({message:"功能预览不支持数据保存",type:"warning"});this.eventType=t,this.$refs.dynamicForm&&this.$refs.dynamicForm.submitForm()}}},d=f,m=a("2877"),c=Object(m["a"])(d,i,n,!1,null,null,null);e["default"]=c.exports}}]);